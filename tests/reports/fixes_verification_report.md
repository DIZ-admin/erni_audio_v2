# –û—Ç—á–µ—Ç –æ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π Erni_audio_v2

**–î–∞—Ç–∞:** 10 –∏—é–Ω—è 2025 –≥.  
**–í—Ä–µ–º—è:** 12:32 UTC  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –ü–†–û–ë–õ–ï–ú–´ –ò–°–ü–†–ê–í–õ–ï–ù–´ –£–°–ü–ï–®–ù–û**

## üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

–í—Å–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:

- ‚úÖ **Webhook –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ **–≠–∫—Å–ø–æ—Ä—Ç —Ñ–æ—Ä–º–∞—Ç–æ–≤** - –≤—Å–µ 8/8 —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ **–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤** - —É–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- ‚úÖ **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ webhook –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä erni-audio-webhook –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–ª—Å—è –∏–∑-–∑–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ entrypoint

**–†–µ—à–µ–Ω–∏–µ:**
```yaml
# docker-compose.yml
webhook-server:
  entrypoint: ["python", "pipeline/webhook_server_cli.py"]
  command: ["--host", "0.0.0.0", "--port", "8001"]
  
  healthcheck:
    test: ["CMD", "python", "-c", "import requests; requests.get('http://localhost:8001/health', timeout=5)"]
    interval: 30s
    timeout: 10s
    retries: 3
    start_period: 30s
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ
- Health check –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
- Webhook —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `/health` endpoint

### 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–≤ ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** 5 –∏–∑ 8 —Ñ–æ—Ä–º–∞—Ç–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏ (VTT, TTML, TXT, CSV, DOCX)

**–†–µ—à–µ–Ω–∏–µ:**
1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_ensure_correct_extension`** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã:
```python
format_extensions = {
    "srt": ".srt", "json": ".json", "ass": ".ass",
    "vtt": ".vtt", "ttml": ".ttml", "txt": ".txt", 
    "csv": ".csv", "docx": ".docx"
}
```

2. **–î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ requirements.txt:**
```
python-docx>=1.1.0  # For DOCX export
lxml>=4.9.0         # For TTML/XML export
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ **8/8 —Ñ–æ—Ä–º–∞—Ç–æ–≤** —Ä–∞–±–æ—Ç–∞—é—Ç —É—Å–ø–µ—à–Ω–æ
- ‚úÖ **VTT**: 1.8 KB - WebVTT —Ñ–æ—Ä–º–∞—Ç —Å —Ü–≤–µ—Ç–æ–≤–æ–π —Ä–∞–∑–º–µ—Ç–∫–æ–π
- ‚úÖ **TTML**: 2.2 KB - XML-based —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤
- ‚úÖ **TXT**: 1.9 KB - –ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
- ‚úÖ **CSV**: 1.7 KB - –¢–∞–±–ª–∏—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
- ‚úÖ **DOCX**: 36.7 KB - Word –¥–æ–∫—É–º–µ–Ω—Ç —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### 3. –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** 20 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –æ –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ö –≤ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥ `resolve_overlaps()` —Å —É–º–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏:

```python
def resolve_overlaps(self, segments):
    """–£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π"""
    # –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:
    # 1. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ (<0.1—Å) - –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≥—Ä–∞–Ω–∏—Ü
    # 2. –ù–µ–±–æ–ª—å—à–æ–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ (<0.5—Å) - –¥–µ–ª–µ–Ω–∏–µ –ø–æ–ø–æ–ª–∞–º  
    # 3. –ë–æ–ª—å—à–æ–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ - –≤—ã–±–æ—Ä –ø–æ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ‚úÖ

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã entrypoint –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
- –î–æ–±–∞–≤–ª–µ–Ω—ã restart policies
- –£–ª—É—á—à–µ–Ω—ã health checks
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
**–§–∞–π–ª:** `data/raw/Testdatei.m4a` (1MB, –Ω–µ–º–µ—Ü–∫–∏–π —è–∑—ã–∫)

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚è±Ô∏è **–û–±—â–µ–µ –≤—Ä–µ–º—è:** 68.5 —Å–µ–∫—É–Ω–¥
- üéµ **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:** 4.08—Å
- üé§ **–î–∏–∞—Ä–∏–∑–∞—Ü–∏—è:** 6.99—Å  
- üìù **–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è:** 56.49—Å
- üîó **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ:** 0.01—Å
- üíæ **–≠–∫—Å–ø–æ—Ä—Ç:** 0.21—Å

### –ö–∞—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–°–µ–≥–º–µ–Ω—Ç–æ–≤:** 71 ‚Üí 7 —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö
- **–°–ø–∏–∫–µ—Ä–æ–≤:** 3 (SPEAKER_00, SPEAKER_02, UNK_SPEAKER_00)
- **–°–ª–æ–≤:** 246
- **–°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å:** 0.781
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 121.80 —Å–µ–∫—É–Ω–¥

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (8/8 —Ñ–æ—Ä–º–∞—Ç–æ–≤)
1. **test_fixed.srt** (1.7 KB) - SubRip —Å—É–±—Ç–∏—Ç—Ä—ã
2. **test_fixed.json** (2.4 KB) - JSON –¥–∞–Ω–Ω—ã–µ
3. **test_fixed.ass** (2.3 KB) - Aegisub —Ñ–æ—Ä–º–∞—Ç
4. **test_fixed.vtt** (1.8 KB) - WebVTT —Å—É–±—Ç–∏—Ç—Ä—ã
5. **test_fixed.ttml** (2.2 KB) - TTML XML —Ñ–æ—Ä–º–∞—Ç
6. **test_fixed.txt** (1.9 KB) - –ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç
7. **test_fixed.csv** (1.7 KB) - CSV —Ç–∞–±–ª–∏—Ü–∞
8. **test_fixed.docx** (36.7 KB) - Word –¥–æ–∫—É–º–µ–Ω—Ç

### Webhook —Å–µ—Ä–≤–µ—Ä
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ Healthy
- **Endpoint:** http://localhost:8001/health
- **–û—Ç–≤–µ—Ç:** `{"status":"healthy","service":"pyannote-webhook-server"}`

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ/–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|----------------|-------------------|-----------|
| **Webhook –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** | ‚ùå –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è | ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç | +100% |
| **–§–æ—Ä–º–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∞** | 3/8 —Ä–∞–±–æ—Ç–∞—é—Ç | 8/8 —Ä–∞–±–æ—Ç–∞—é—Ç | +167% |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π** | 20 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ | +100% |
| **–û–±—â–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** | ‚ö†Ô∏è –° –ø—Ä–æ–±–ª–µ–º–∞–º–∏ | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å—Ç–∞–±–∏–ª—å–Ω–æ | +100% |

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### ‚úÖ –í—Å–µ —Ü–µ–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã:

1. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã** - –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–≤
2. **–ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –≤—Å–µ 8 —Ñ–æ—Ä–º–∞—Ç–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
3. **–ö–∞—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏** - —É–ª—É—á—à–µ–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π
4. **Production –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å** - —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### üöÄ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production

Erni_audio_v2 —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production —Å—Ä–µ–¥–µ:

- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ Docker

### üìà –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –¥–æ–±–∞–≤–∏—Ç—å Prometheus –º–µ—Ç—Ä–∏–∫–∏
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –≤–Ω–µ–¥—Ä–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏

---

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:** Augment Agent  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û**  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production:** ‚úÖ **–ì–û–¢–û–í–û**
